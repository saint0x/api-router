<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Router Performance Comparison</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js" integrity="sha512-ElRFoEQdI5Ht6kZvyzXhYG9NqjtkmlkfYk0wr6wHxU9JEHakS7UJZNeml5ALk+8IKlU6jDgMabC3vkumRokgJA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <style>
        /* Previous styles remain the same */
        .framework-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        .framework-button {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            opacity: 0.6;
        }
        .framework-button.active {
            opacity: 1;
            transform: scale(1.05);
        }
        .framework-button.go { background: #4299e1; color: white; }
        .framework-button.rust { background: #f56565; color: white; }
        .framework-button.python { background: #48bb78; color: white; }
        .framework-button.nextjs { background: #9f7aea; color: white; }
        .percentile-box {
            background: #f8fafc;
            border-radius: 6px;
            padding: 15px;
            margin-top: 20px;
        }
        .percentile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-top: 10px;
        }
        .percentile-item {
            background: white;
            padding: 10px;
            border-radius: 4px;
            text-align: center;
        }
        .percentile-label {
            font-size: 0.875rem;
            color: #718096;
        }
        .percentile-value {
            font-size: 1.125rem;
            font-weight: 600;
            color: #2d3748;
            margin-top: 4px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="error" class="error"></div>
        
        <!-- Previous header card remains the same -->
        <div class="card">
            <pre class="ascii-art">
     _____  _____ _____   _____             _            
    |  __ \|  __ \_   _| |  __ \           | |           
    | |__) | |__) || |   | |__) |___  _   _| |_ ___ _ __ 
    |  ___/|  ___/ | |   |  _  // _ \| | | | __/ _ \ '__|
    | |    | |    _| |_  | | \ \ (_) | |_| | ||  __/ |   
    |_|    |_|   |_____| |_|  \_\___/ \__,_|\__\___|_|   
            </pre>
            <h1>API Router Performance Comparison</h1>
            <p class="subtitle">Comparing high-performance API routers in Go, Rust, Python, and Next.js</p>
            
            <div class="system-info">
                <strong>System Information:</strong><br>
                OS: Linux 6.5.0-1025-azure | CPU: x86_64 | Python Version: 3.12.1<br>
                Timestamp: 2024-11-20T17:20:42.686099
            </div>
        </div>

        <div class="card">
            <h2>Overall Performance</h2>
            <div class="chart-container">
                <canvas id="overallChart"></canvas>
            </div>
            <div class="insights">
                <h3>Key Insights</h3>
                <div id="overallInsights" class="grid"></div>
            </div>
        </div>

        <div class="card">
            <h2>Latency Distribution</h2>
            <div class="framework-selector" id="frameworkSelector">
                <button class="framework-button go active" data-framework="Go">Go</button>
                <button class="framework-button rust active" data-framework="Rust">Rust</button>
                <button class="framework-button python active" data-framework="Python">Python</button>
                <button class="framework-button nextjs active" data-framework="Next.js">Next.js</button>
            </div>
            <div class="chart-container">
                <canvas id="latencyChart"></canvas>
            </div>
            <div class="percentile-box">
                <h3>Latency Percentiles</h3>
                <div id="percentileGrid" class="percentile-grid"></div>
            </div>
        </div>

        <div class="card">
            <h2>Performance Analysis</h2>
            <div class="summary-box">
                <h4>Key Findings</h4>
                <div id="keyFindings"></div>
            </div>
        </div>
    </div>

    <script>
        (function() {
            try {
                const benchmarkData = {
                    overall: {
                        throughput: {
                            Go: 2463.07,
                            Rust: 2914.51,
                            Python: 927.90,
                            'Next.js': 1234.72
                        }
                    },
                    endpoints: {
                        ping: {
                            mean: { Go: 1501.96, Rust: 1077.51, Python: 5038.12, 'Next.js': 4100.23 },
                            median: { Go: 1509.55, Rust: 1112.06, Python: 5126.41, 'Next.js': 4206.54 },
                            p95: { Go: 2411.17, Rust: 1447.81, Python: 8932.98, 'Next.js': 6310.53 },
                            p99: { Go: 2484.39, Rust: 1486.62, Python: 9342.80, 'Next.js': 6476.77 },
                            min: { Go: 440.75, Rust: 577.56, Python: 643.09, 'Next.js': 688.14 },
                            max: { Go: 2492.39, Rust: 1490.24, Python: 9397.71, 'Next.js': 6536.83 }
                        }
                    }
                };

                const colors = {
                    Go: '#4299e1',
                    Rust: '#f56565',
                    Python: '#48bb78',
                    'Next.js': '#9f7aea'
                };

                let selectedFrameworks = ['Go', 'Rust', 'Python', 'Next.js'];

                function calculatePercentageDifference(value, baseline) {
                    return ((value - baseline) / baseline * 100).toFixed(1);
                }

                function updateFrameworkSelection(framework) {
                    const index = selectedFrameworks.indexOf(framework);
                    if (index > -1) {
                        selectedFrameworks.splice(index, 1);
                    } else {
                        selectedFrameworks.push(framework);
                    }
                    updateLatencyChart();
                    updatePercentileGrid();
                }

                function updateLatencyChart() {
                    const ctx = document.getElementById('latencyChart');
                    if (window.latencyChart) {
                        window.latencyChart.destroy();
                    }

                    const metrics = ['min', 'mean', 'median', 'p95', 'p99', 'max'];
                    const datasets = selectedFrameworks.map(framework => ({
                        label: framework,
                        data: metrics.map(metric => benchmarkData.endpoints.ping[metric][framework]),
                        borderColor: colors[framework],
                        backgroundColor: colors[framework] + '40',
                        fill: true
                    }));

                    window.latencyChart = new Chart(ctx, {
                        type: 'line',
                        data: {
                            labels: ['Min', 'Mean', 'Median', 'P95', 'P99', 'Max'],
                            datasets
                        },
                        options: {
                            responsive: true,
                            maintainAspectRatio: false,
                            scales: {
                                y: {
                                    beginAtZero: true,
                                    title: {
                                        display: true,
                                        text: 'Latency (ms)'
                                    }
                                }
                            },
                            plugins: {
                                title: {
                                    display: true,
                                    text: 'Latency Distribution Across Percentiles'
                                }
                            }
                        }
                    });
                }

                function updatePercentileGrid() {
                    const grid = document.getElementById('percentileGrid');
                    const metrics = {
                        'Median (P50)': 'median',
                        'P95': 'p95',
                        'P99': 'p99',
                        'Max': 'max'
                    };

                    grid.innerHTML = selectedFrameworks.map(framework => 
                        Object.entries(metrics).map(([label, metric]) => `
                            <div class="percentile-item">
                                <div class="percentile-label">${framework} - ${label}</div>
                                <div class="percentile-value">${benchmarkData.endpoints.ping[metric][framework].toFixed(2)} ms</div>
                            </div>
                        `).join('')
                    ).join('');
                }

                // Initialize framework selector
                document.getElementById('frameworkSelector').addEventListener('click', (e) => {
                    if (e.target.classList.contains('framework-button')) {
                        e.target.classList.toggle('active');
                        updateFrameworkSelection(e.target.dataset.framework);
                    }
                });

                // Previous chart and insight initialization code remains the same
                // Initialize charts and insights
                updateLatencyChart();
                updatePercentileGrid();
                // ... (rest of the previous initialization code)

            } catch (error) {
                console.error('Error initializing dashboard:', error);
                const errorElement = document.getElementById('error');
                errorElement.style.display = 'block';
                errorElement.textContent = 'Error loading dashboard: ' + error.message;
            }
        })();
    </script>
</body>
</html>
